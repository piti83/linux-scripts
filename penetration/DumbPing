#!/bin/bash

# I don't know if it has any value. ICMP is usually blocked.
# Therefore ARP scanning is 100x better than this 
# (assuming you're scanning LAN, you wouldn't try to scan external servers wouldn't you?)
# but WHO CARES.

if [[ "$1" == "--help" || -z "$1" ]]; then
  cat << EOF
============================================================
DumbPing - Stupidly simple /24 network scanner
============================================================

DESCRIPTION:
    This script performs a rapid ping sweep of a /24 network
    range. It runs all processes in the background so its 
    rather quick. Should take roughly 1 second.

USAGE:
    ./DumbPing <first_3_octets>

EXAMPLES:
    ./DumbPing 192.168.1
    ./DumbPing 8.8.8

TECHNICAL NOTES:
    - ICMP traffic might be dropped by firewalls.
    - Uses /tmp/ping_script_hits as a temporary counter.

AUTHOR: piti83
============================================================
EOF
  exit 0
fi

if [[ ! "$1" =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then
    echo "Error: Invalid or missing argument."
    echo "Expected format: XXX.XXX.XXX (e.g., 192.168.1)"
    echo "Type './DumbPing --help' for more info."
    exit 1
fi

NETWORK=$1
> /tmp/ping_script_hits

for i in {0..255} 
do
  (
    IP="$NETWORK.$i"
    ping -c 1 -W 1 "$IP" > /dev/null 2>&1
    if [ $? -eq 0 ]; then
      NAME=$(getent hosts "$IP" | awk '{print $2}')
      printf "[HOST REACHABLE] %-15s (%s)\n" "$IP" "$NAME"
      echo "OH THERE YOU ARE :)))))" >> /tmp/ping_script_hits
    fi
  ) &
done

wait
echo "$(wc -l < /tmp/ping_script_hits)/256 hosts responded."
rm /tmp/ping_script_hits
echo "Scanning done."

